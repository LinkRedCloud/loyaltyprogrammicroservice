define(["ojs/ojcore","knockout","ojs/ojknockout"],function(e,o){function t(){var t=this;t.globalContext={},t.globalContextListeners=[],t.registerGlobalContextListener=function(e){console.log("New global context listener is registered"),t.globalContextListeners.push(e)};var n=e.ResponsiveUtils.getFrameworkQuery(e.ResponsiveUtils.FRAMEWORK_QUERY_KEY.SM_ONLY);t.smScreen=e.ResponsiveKnockoutUtils.createMediaQueryObservable(n),t.appName=o.observable("Loyalty Points"),t.callParent=function(e){console.log("send message from Loyalty Points to parent window");parent.postMessage(e,"*")},t.init=function(){window.addEventListener("message",function(e){console.log("Received message from embedding application "+e),console.log("Payload =  "+JSON.stringify(e.data)),"globalContext"==e.data.eventType&&(t.globalContext=e.data.payload.globalContext,console.log("Inform all listeners about the globalContext"),t.globalContextListeners.forEach(function(e){e(t.globalContext)}))},!1),t.callParent({childHasLoaded:!0})},$(document).ready(function(){t.init()})}return new t});